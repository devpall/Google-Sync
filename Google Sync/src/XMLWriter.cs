using System.Xml.Linq;
using System;
using Google_Sync.src.Outlook;

namespace Google_Sync.src
{
    class XMLWriter
    {
        private XDocument XMLDoc;

        public XMLWriter()
        {
            CreateXML();
        }

        public void CreateXML()
        {
            XMLDoc = new XDocument(
                new XDeclaration("1.0", "UTF-8", "yes"),
                new XComment("Build by Google Outlook sync - do not edit this file"),
                new XElement("Appointments")
                );
            XMLDoc.Save(System.Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + @"\Google Sync\Outlook.xml");
        }

        public void AddNode(Item item)
        {
            XMLDoc = XDocument.Load(System.Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + @"\Google Sync\Outlook.xml");
            XElement newNode = new XElement("Appointment",
                new XAttribute("ID", item.id),
                new XElement("Subject", item.subject),
                new XElement("Categorie", item.category),
                new XElement("Location",item.location),
                new XElement("AllDay", item.allDayEvent.ToString()),
                new XElement("StartTime",item.startTime),
                new XElement("EndTime", item.endTime),
                new XElement("Recipients",item.group),
                new XElement("Recurring", 
                    new XAttribute("IS",item.isReturning.ToString()),
                    new XElement ("Intervall",item.intervall.ToString()),
                    new XElement ("Occurences", item.occurences.ToString()),
                    new XElement ("PatternStartDate", item.patternStartDate),
                    new XElement ("NoEndDate", item.noEndDate.ToString()),
                    new XElement ("PatternEndDate", item.patternEndDate)
                            )
              );

            XMLDoc.Element("Appointments").Add(newNode);
           
            XMLDoc.Save(System.Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + @"\Google Sync\Outlook.xml");
        }
    }
}
   